# k3s agent configuration
# Generated by Ansible

# Server connection
server: {{ k3s_worker_server_url }}
token: {{ k3s_worker_node_token }}

# Data directory
data-dir: {{ k3s_data_dir }}

# Node configuration
{% if k3s_node_labels %}
node-label:
{% for key, value in k3s_node_labels.items() %}
  - {{ key }}={{ value }}
{% endfor %}
{% endif %}

{% if k3s_node_taints %}
node-taint:
{% for taint in k3s_node_taints %}
  - {{ taint }}
{% endfor %}
{% endif %}

# Kubelet arguments
{% if k3s_kubelet_args %}
kubelet-arg:
{% for arg in k3s_kubelet_args %}
  - {{ arg }}
{% endfor %}
{% endif %}

# Kube-proxy arguments
{% if k3s_kube_proxy_args %}
kube-proxy-arg:
{% for arg in k3s_kube_proxy_args %}
  - {{ arg }}
{% endfor %}
{% endif %}

# Security
protect-kernel-defaults: true

# Logging
log: /var/log/k3s-agent.log

# Ansible Lint configuration for homelab k3s cluster

# Exclude specific paths
exclude_paths:
  - .cache/
  - .github/
  - kubernetes/
  - docs/
  - scripts/

# Enable offline mode
offline: false

# Use default rules but with customizations
use_default_rules: true

# Skip specific rules that may not apply to our use case
skip_list:
  - yaml[line-length]           # Allow longer lines for readability
  - name[casing]               # Allow flexible naming conventions
  - fqcn[action-core]          # Allow core module names without FQCN
  - risky-file-permissions     # We set permissions explicitly where needed
  - command-instead-of-module  # Some commands are necessary for k3s setup
  - no-changed-when            # Some tasks legitimately change system state

# Rules to enable (in addition to defaults)
enable_list:
  - yaml[truthy]               # Enforce consistent boolean values
  - yaml[brackets]             # Enforce consistent bracket usage
  - yaml[commas]               # Enforce consistent comma usage

# Warn on specific rules instead of failing
warn_list:
  - experimental               # Warn about experimental features
  - role-name                  # Warn about role naming conventions

# Mock modules and plugins that may not be available in CI
mock_modules:
  - kubernetes.core.k8s
  - kubernetes.core.k8s_info
  - community.general.ufw
  - community.general.timezone

mock_roles:
  - common
  - k3s_common

# Tags to run
tags: []

# Verbosity level
verbosity: 1

# Loop variable naming
loop_var_prefix: __

# Rules configuration
rules:
  # YAML formatting rules
  yaml[line-length]:
    max: 120
    level: relax
  
  # Variable naming rules
  var-naming[no-role-prefix]:
    level: moderate

  # File naming rules
  name[template]:
    level: moderate

  # Complexity rules
  complexity[tasks]:
    max_block_depth: 20